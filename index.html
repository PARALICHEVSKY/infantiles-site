<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>MeowSim ‚Äî –ú—è—É—Å–∏–º (–±—Ä–∞—É–∑–µ—Ä)</title>
  <style>
    :root{--bg:#f7f7fb;--panel:#fff;--accent:#6b9e6f}
    html,body{height:100%;margin:0;font-family:Inter,Segoe UI,Helvetica,Arial,sans-serif;background:var(--bg);color:#222}
    .wrap{max-width:1000px;margin:20px auto;display:flex;gap:16px}
    .game{flex:1;background:var(--panel);box-shadow:0 6px 18px rgba(15,15,20,0.06);border-radius:12px;padding:14px}
    .sidebar{width:300px;background:var(--panel);box-shadow:0 6px 18px rgba(15,15,20,0.06);border-radius:12px;padding:14px;display:flex;flex-direction:column;gap:12px}
    canvas{background:linear-gradient(#f4f7fb,#eef2f6);width:100%;height:440px;border-radius:8px;display:block}
    h1{font-size:18px;margin:0 0 6px}
    .stats{display:flex;flex-direction:column;gap:8px}
    .bar{background:#eee;border-radius:6px;padding:6px 8px;display:flex;justify-content:space-between;align-items:center}
    .bar .meter{height:10px;background:#ddd;border-radius:6px;flex:1;margin-left:8px;margin-right:8px;overflow:hidden}
    .meter > i{display:block;height:100%;background:var(--accent);width:50%}
    button{background:var(--accent);color:#fff;border:0;padding:10px;border-radius:8px;cursor:pointer;font-weight:600}
    button.secondary{background:#4a6b83}
    .messages{height:110px;overflow:auto;background:#fafafa;border-radius:8px;padding:8px;font-size:13px;border:1px solid #eee}
    .toprow{display:flex;gap:8px}
    .shop-list{display:flex;flex-direction:column;gap:10px}
    .shop-item{display:flex;justify-content:space-between;align-items:center;padding:8px;border-radius:8px;background:#fff;border:1px solid #eee}
    .inventory{display:flex;flex-wrap:wrap;gap:8px}
    .toy{padding:6px 10px;border-radius:8px;background:#fff;border:1px solid #eee;font-size:13px}
    footer{margin-top:8px;font-size:12px;color:#666}
    @media(max-width:880px){.wrap{flex-direction:column}.sidebar{width:100%}}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="game">
      <h1>MeowSim ‚Äî –ú—è—É—Å–∏–º (–±—Ä–∞—É–∑–µ—Ä)</h1>
      <canvas id="gameCanvas" width="680" height="440"></canvas>
      <div style="display:flex;gap:8px;margin-top:10px;">
        <button id="feedBtn">–ü–æ–∫–æ—Ä–º–∏—Ç—å (5 ü™ô)</button>
        <button id="playBtn">–ü–æ–∏–≥—Ä–∞—Ç—å</button>
        <button id="sleepBtn">–£–ª–æ–∂–∏—Ç—å —Å–ø–∞—Ç—å</button>
        <button id="shopBtn" class="secondary">–û—Ç–∫—Ä—ã—Ç—å –º–∞–≥–∞–∑–∏–Ω</button>
        <button id="saveBtn" class="secondary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        <button id="loadBtn" class="secondary">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
      </div>
      <div style="margin-top:10px;display:flex;gap:8px;align-items:flex-start">
        <div style="flex:1">
          <div class="messages" id="messages"></div>
          <footer>–ö–ª–∏–∫ –ø–æ –∫–æ—Ç—É ‚Äî –ø–æ–≥–ª–∞–¥–∏—Ç—å. –ò–≥—Ä—É—à–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∫–Ω–æ–ø–∫–æ–π "–ü–æ–∏–≥—Ä–∞—Ç—å".</footer>
        </div>
        <div style="width:220px">
          <div style="font-size:13px;color:#444">–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</div>
          <div class="inventory" id="inventory"></div>
        </div>
      </div>
    </div>

    <div class="sidebar">
      <div>
        <div style="display:flex;justify-content:space-between;align-items:center">
          <strong id="catName">–ú—É—Ä–∑–∏–∫</strong>
          <span id="coins">ü™ô 20</span>
        </div>
        <div style="margin-top:8px;font-size:13px;color:#555">–°—Ç–∞—Ç—ã –∫–æ—Ç–∞</div>
      </div>

      <div class="stats">
        <div class="bar">–ì–æ–ª–æ–¥ <div class="meter" id="hungerMeter"><i></i></div></div>
        <div class="bar">–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ <div class="meter" id="happyMeter"><i></i></div></div>
        <div class="bar">–≠–Ω–µ—Ä–≥–∏—è <div class="meter" id="energyMeter"><i></i></div></div>
      </div>

      <div>
        <div style="display:flex;justify-content:space-between;align-items:center"><strong>–ú–∞–≥–∞–∑–∏–Ω</strong><small style="color:#777"> (–Ω–∞–∂–º–∏)</small></div>
        <div style="margin-top:6px;color:#666;font-size:13px">–ú—è—á–∏–∫ ‚Äî 10 ü™ô, –ü–µ—Ä–æ ‚Äî 20 ü™ô, –õ–∞–∑–µ—Ä ‚Äî 50 ü™ô</div>
      </div>

      <div style="margin-top:auto">
        <small style="color:#666">–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ: localStorage (–≤ —ç—Ç–æ–º –±—Ä–∞—É–∑–µ—Ä–µ).</small>
      </div>
    </div>
  </div>

  <!-- Shop modal (simple) -->
  <div id="shopModal" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.4);align-items:center;justify-content:center">
    <div style="background:var(--panel);padding:14px;border-radius:10px;min-width:320px;max-width:90%">
      <h3 style="margin-top:0">–ú–∞–≥–∞–∑–∏–Ω –∏–≥—Ä—É—à–µ–∫</h3>
      <div class="shop-list">
        <div class="shop-item"><div>1) –ú—è—á–∏–∫</div><div>10 ü™ô <button data-buy="ball">–ö—É–ø–∏—Ç—å</button></div></div>
        <div class="shop-item"><div>2) –ü–µ—Ä–æ</div><div>20 ü™ô <button data-buy="feather">–ö—É–ø–∏—Ç—å</button></div></div>
        <div class="shop-item"><div>3) –õ–∞–∑–µ—Ä</div><div>50 ü™ô <button data-buy="laser">–ö—É–ø–∏—Ç—å</button></div></div>
      </div>
      <div style="text-align:right;margin-top:10px"><button id="closeShop" class="secondary">–ó–∞–∫—Ä—ã—Ç—å</button></div>
    </div>
  </div>

  <script>
    // Simple MeowSim browser version (single-file)
    (function(){
      const canvas = document.getElementById('gameCanvas');
      const ctx = canvas.getContext('2d');
      let W = canvas.width, H = canvas.height;

      // Game state
      const state = {
        name: '–ú—É—Ä–∑–∏–∫',
        hunger: 70, // 0..100 (100 = full)
        happiness: 80,
        energy: 80,
        coins: 20,
        toys: [] // {id:'ball',name,playValue}
      };

      // Toys data
      const shop = {
        ball: {id:'ball', name:'–ú—è—á–∏–∫', price:10, playValue:18},
        feather: {id:'feather', name:'–ü—ë—Ä—ã—à–∫–æ', price:20, playValue:30},
        laser: {id:'laser', name:'–õ–∞–∑–µ—Ä', price:50, playValue:60}
      };

      // UI elements
      const feedBtn = document.getElementById('feedBtn');
      const playBtn = document.getElementById('playBtn');
      const sleepBtn = document.getElementById('sleepBtn');
      const shopBtn = document.getElementById('shopBtn');
      const saveBtn = document.getElementById('saveBtn');
      const loadBtn = document.getElementById('loadBtn');
      const messages = document.getElementById('messages');
      const inventory = document.getElementById('inventory');
      const coinsEl = document.getElementById('coins');
      const shopModal = document.getElementById('shopModal');

      function addMessage(t){
        const el = document.createElement('div'); el.textContent = t; messages.prepend(el);
        while(messages.children.length>6) messages.removeChild(messages.lastChild);
      }

      function updateSidebar(){
        document.getElementById('catName').textContent = state.name;
        coinsEl.textContent = 'ü™ô ' + state.coins;
        setMeter('hungerMeter', state.hunger);
        setMeter('happyMeter', state.happiness);
        setMeter('energyMeter', state.energy);
        renderInventory();
      }
      function setMeter(id, val){ const el = document.getElementById(id); el.children[0].style.width = Math.max(0,Math.min(100,val)) + '%'; }

      function renderInventory(){ inventory.innerHTML='';
        if(state.toys.length===0){ inventory.innerHTML = '<div style="color:#777">–ü—É—Å—Ç–æ</div>'; return; }
        state.toys.forEach((t,i)=>{
          const d = document.createElement('div'); d.className='toy'; d.textContent = t.name; inventory.appendChild(d);
        });
      }

      // Buttons
      feedBtn.addEventListener('click', ()=>{
        if(state.coins >=5){ state.coins -=5; state.hunger = Math.min(100, state.hunger + 30); state.happiness = Math.min(100, state.happiness + 5); addMessage('–¢—ã –ø–æ–∫–æ—Ä–º–∏–ª '+state.name+' (+30 –≥–æ–ª–æ–¥–∞)'); }
        else addMessage('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç —á—Ç–æ–±—ã –ø–æ–∫–æ—Ä–º–∏—Ç—å.');
        updateSidebar();
      });

      playBtn.addEventListener('click', ()=>{
        if(state.energy < 15){ addMessage(state.name+' —Å–ª–∏—à–∫–æ–º —É—Å—Ç–∞–ª –∏–≥—Ä–∞—Ç—å.'); return; }
        if(state.toys.length === 0){ addMessage('–£ —Ç–µ–±—è –Ω–µ—Ç –∏–≥—Ä—É—à–µ–∫ ‚Äî –∫—É–ø–∏ –≤ –º–∞–≥–∞–∑–∏–Ω–µ.'); return; }
        // choose random toy
        const t = state.toys[Math.floor(Math.random()*state.toys.length)];
        state.happiness = Math.min(100, state.happiness + t.playValue);
        state.energy = Math.max(0, state.energy - 10);
        state.hunger = Math.max(0, state.hunger - Math.floor(t.playValue/5));
        addMessage('–í—ã –ø–æ–∏–≥—Ä–∞–ª–∏ —Å '+state.name+' –∏ –∏–≥—Ä—É—à–∫–æ–π ¬´'+t.name+'¬ª (+'+t.playValue+' –Ω–∞—Å—Ç.).');
        updateSidebar();
      });

      sleepBtn.addEventListener('click', ()=>{
        state.energy = Math.min(100, state.energy + 40);
        state.hunger = Math.max(0, state.hunger - 15);
        addMessage(state.name + ' –ø–æ—Å–ø–∞–ª –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏–ª —ç–Ω–µ—Ä–≥–∏—é.'); updateSidebar();
      });

      shopBtn.addEventListener('click', ()=>{ shopModal.style.display='flex'; });
      document.getElementById('closeShop').addEventListener('click', ()=>{ shopModal.style.display='none'; });

      // shop buy buttons
      Array.from(document.querySelectorAll('[data-buy]')).forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const id = btn.getAttribute('data-buy'); const item = shop[id];
          if(state.coins >= item.price){ state.coins -= item.price; state.toys.push(Object.assign({},item)); addMessage('–ö—É–ø–ª–µ–Ω–æ: '+item.name); updateSidebar(); }
          else addMessage('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç –Ω–∞ '+item.name);
        });
      });

      saveBtn.addEventListener('click', ()=>{ localStorage.setItem('meowsim_save', JSON.stringify(state)); addMessage('–ò–≥—Ä–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ localStorage.'); });
      loadBtn.addEventListener('click', ()=>{ const s = localStorage.getItem('meowsim_save'); if(!s){ addMessage('–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.'); return;} const loaded = JSON.parse(s); Object.assign(state, loaded); addMessage('–ò–≥—Ä–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞.'); updateSidebar(); });

      // canvas drawing & interaction
      let messagesQueue = [];
      function draw(){
        ctx.clearRect(0,0,W,H);
        // floor
        ctx.fillStyle = '#eef2f6'; ctx.fillRect(0,320,W,H-320);

        // cat body
        const cx=220, cy=180, r=110;
        ctx.fillStyle='#caaea3'; ctx.beginPath(); ctx.ellipse(cx,cy, r, r, 0,0,Math.PI*2); ctx.fill();
        // face
        ctx.fillStyle='#e3d2c8'; ctx.beginPath(); ctx.ellipse(cx,cy-20,60,60,0,0,Math.PI*2); ctx.fill();
        // eyes
        ctx.fillStyle='#fff'; ctx.fillRect(cx-30, cy-40, 28, 18); ctx.fillRect(cx+2, cy-40,28,18);
        ctx.fillStyle='#000'; ctx.fillRect(cx-22, cy-36,8,8); ctx.fillRect(cx+10, cy-36,8,8);
        // nose
        ctx.fillStyle='#b46b79'; ctx.beginPath(); ctx.moveTo(cx,cy-18); ctx.lineTo(cx-6, cy-6); ctx.lineTo(cx+6, cy-6); ctx.fill();
        // mouth
        ctx.strokeStyle='#6b4b4b'; ctx.beginPath(); ctx.arc(cx-8, cy+2, 8, Math.PI*0.15, Math.PI*0.95); ctx.stroke(); ctx.beginPath(); ctx.arc(cx+8, cy+2, 8, Math.PI*0.05, Math.PI*0.85); ctx.stroke();
        // ears
        ctx.fillStyle='#caaea3'; ctx.beginPath(); ctx.moveTo(cx-60, cy-60); ctx.lineTo(cx-40, cy-110); ctx.lineTo(cx-20, cy-60); ctx.fill();
        ctx.beginPath(); ctx.moveTo(cx+60, cy-60); ctx.lineTo(cx+40, cy-110); ctx.lineTo(cx+20, cy-60); ctx.fill();

        // toys in inventory on right of canvas
        ctx.fillStyle='#fff'; ctx.fillRect(380, 40, 280, 240); ctx.strokeStyle='#ddd'; ctx.strokeRect(380,40,280,240);
        ctx.fillStyle='#000'; ctx.fillText('–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å (–¥–ª—è –ø–æ–∫–∞–∑–∞)', 390, 56);
        state.toys.forEach((t,i)=>{
          const ix = 420 + (i%2)*120; const iy = 120 + Math.floor(i/2)*70;
          ctx.fillStyle = '#d8e6ff'; ctx.beginPath(); ctx.ellipse(ix+24, iy+24, 24, 24, 0,0,Math.PI*2); ctx.fill(); ctx.strokeStyle='#b9c7e8'; ctx.stroke(); ctx.fillStyle='#000'; ctx.fillText(t.name, ix+56, iy+28);
        });

        // events area (messages)
        ctx.fillStyle='#000'; ctx.fillText('–°–æ–±—ã—Ç–∏—è:', 20, 420);
        ctx.font='13px sans-serif'; let my = 436; for(let i=0;i<Math.min(6,messages.children.length);i++){ const t = messages.children[i].textContent; ctx.fillText(t,20,my); my+=16; }

        // small stat bars
        drawBar(20,20,'–ì–æ–ª–æ–¥', state.hunger); drawBar(20,50,'–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ', state.happiness); drawBar(20,80,'–≠–Ω–µ—Ä–≥–∏—è', state.energy);
      }
      function drawBar(x,y,label,val){ ctx.font='12px sans-serif'; ctx.fillStyle='#000'; ctx.fillText(label+': '+val+'/100', x, y+10); ctx.fillStyle='#ddd'; ctx.fillRect(x+100,y,160,12); ctx.fillStyle='#6b9e6f'; ctx.fillRect(x+100,y,1.6*val,12); ctx.strokeStyle='#000'; ctx.strokeRect(x+100,y,160,12); }

      // click to pet
      canvas.addEventListener('click', (ev)=>{
        const rect = canvas.getBoundingClientRect(); const x = (ev.clientX - rect.left)*(canvas.width/rect.width); const y = (ev.clientY - rect.top)*(canvas.height/rect.height);
        const cx=220, cy=180, r=110; if((x-cx)*(x-cx)+(y-cy)*(y-cy) <= r*r){ state.happiness = Math.min(100, state.happiness+5); addMessage('–¢—ã –ø–æ–≥–ª–∞–¥–∏–ª '+state.name+' (+5 –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è)'); updateSidebar(); }
      });

      // ticks
      setInterval(()=>{
        state.hunger = Math.max(0, state.hunger - 1);
        state.energy = Math.max(0, state.energy - 1);
        if(state.hunger < 20) state.happiness = Math.max(0, state.happiness - 2);
        if(state.energy < 15) state.happiness = Math.max(0, state.happiness - 1);
        if(state.happiness > 80 && Math.random()<0.02) { state.coins += 1; addMessage('–¢—ã –Ω–∞—à—ë–ª 1 –º–æ–Ω–µ—Ç–∫—É!'); }
        updateSidebar(); draw();
      }, 1000);

      // initial
      addMessage('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ MeowSim! –ö–ª–∏–∫–Ω–∏ –ø–æ –∫–æ—Ç—É —á—Ç–æ–±—ã –ø–æ–≥–ª–∞–¥–∏—Ç—å.'); updateSidebar(); draw();

      // responsive canvas
      function resize(){ const rect = canvas.getBoundingClientRect(); W = canvas.width = 680; H = canvas.height = 440; draw(); }
      window.addEventListener('resize', resize);

      // load earlier save if present
      const s = localStorage.getItem('meowsim_save'); if(s){ try{ const loaded = JSON.parse(s); Object.assign(state, loaded); addMessage('–ó–∞–≥—Ä—É–∂–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ.'); updateSidebar(); }catch(e){} }

    })();
  </script>
</body>
</html>
