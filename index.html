<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CS:GO Case Battle Ultra</title>
<style>
body {margin:0;padding:0;font-family:sans-serif;background:linear-gradient(135deg,#0b0c17,#1b1f3a);color:white;display:flex;justify-content:center;align-items:center;height:100vh;overflow:hidden;}
.container {background:rgba(0,0,0,0.75);border-radius:16px;padding:20px;text-align:center;width:90vw;max-width:800px;position:relative;overflow:hidden;}
h1 {margin-bottom:20px;}
button {padding:10px 20px;font-size:16px;border:none;border-radius:10px;cursor:pointer;background:linear-gradient(90deg,#7c5cff,#22d3ee);color:white;margin-top:15px;}
.case-window {margin-top:20px;height:140px;overflow:hidden;border:1px solid rgba(255,255,255,0.2);border-radius:12px;position:relative;background:rgba(255,255,255,0.02);}
.items {display:flex;position:absolute;top:0;left:0;}
.item {min-width:120px;margin:0 10px;border-radius:8px;display:flex;justify-content:center;align-items:center;font-weight:bold;font-size:14px;padding:10px;color:white;position:relative;transition:0.3s;}
.common{background:#555;}
.rare{background:#4e9eff;box-shadow:0 0 10px #4e9eff;}
.legendary{background:#ffb700;box-shadow:0 0 12px #ffb700;}
.ultra{background:#ff4d4d;box-shadow:0 0 15px #ff4d4d;}
.result {margin-top:15px;font-size:18px;font-weight:bold;min-height:24px;position:relative;}
.history {margin-top:15px;max-height:120px;overflow-y:auto;border-top:1px solid rgba(255,255,255,0.2);padding-top:10px;text-align:left;}
.progress-container {width:100%;background:rgba(255,255,255,0.1);border-radius:8px;margin-top:10px;height:10px;overflow:hidden;}
.progress-bar {height:100%;width:0%;background:linear-gradient(90deg,#7c5cff,#22d3ee);transition:width 0.2s;}
.flash {position:absolute;top:10px;left:50%;transform:translateX(-50%);font-size:26px;font-weight:bold;color:gold;text-shadow:0 0 10px yellow;animation:flashAnim 1s forwards;}
@keyframes flashAnim {0%{opacity:0;transform:translateX(-50%) scale(0.5);}50%{opacity:1;transform:translateX(-50%) scale(1.3);}100%{opacity:0;transform:translateX(-50%) scale(1);}}
</style>
</head>
<body>
<div class="container" id="container">
  <h1>CS:GO Case Battle Ultra</h1>
  <select id="caseSelect">
    <option value="1">Кейс Стандарт</option>
    <option value="2">Кейс Мистика</option>
    <option value="3">Кейс Легенд</option>
  </select>
  <div class="case-window">
    <div class="items" id="itemsRow"></div>
  </div>
  <div class="progress-container">
    <div class="progress-bar" id="progressBar"></div>
  </div>
  <button id="openBtn">Открыть кейс</button>
  <div class="result" id="resultText"></div>
  <div class="history" id="history"></div>
</div>

<audio id="openSound" src="https://freesound.org/data/previews/234/234172_4019026-lq.mp3"></audio>
<audio id="rareSound" src="https://freesound.org/data/previews/331/331912_3248244-lq.mp3"></audio>

<script>
const itemsRow = document.getElementById('itemsRow');
const openBtn = document.getElementById('openBtn');
const resultText = document.getElementById('resultText');
const historyDiv = document.getElementById('history');
const progressBar = document.getElementById('progressBar');
const container = document.getElementById('container');
const openSound = document.getElementById('openSound');
const rareSound = document.getElementById('rareSound');

const weapons = [
  {name:'AK-47 | Redline', rarity:'rare', chance:0.2},
  {name:'M4A1-S | Hyper Beast', rarity:'legendary', chance:0.1},
  {name:'AWP | Dragon Lore', rarity:'ultra', chance:0.02},
  {name:'Glock-18 | Fade', rarity:'common', chance:0.3},
  {name:'Desert Eagle | Blaze', rarity:'legendary', chance:0.1},
  {name:'USP-S | Kill Confirmed', rarity:'rare', chance:0.15},
  {name:'P90 | Death by Kitty', rarity:'common', chance:0.25},
  {name:'Karambit | Doppler', rarity:'ultra', chance:0.02},
  {name:'AK-47 | Fire Serpent', rarity:'ultra', chance:0.02},
  {name:'AWP | Asiimov', rarity:'legendary', chance:0.08},
  {name:'M4A4 | Howl', rarity:'ultra', chance:0.01}
];

function getRandomWeapon() {
  let r = Math.random();
  let sum = 0;
  for(const w of weapons){
    sum += w.chance;
    if(r <= sum) return w;
  }
  return weapons[0];
}

function generateCaseItems() {
  itemsRow.innerHTML = '';
  for(let i=0;i<30;i++){
    const w = weapons[Math.floor(Math.random()*weapons.length)];
    const item = document.createElement('div');
    item.className='item '+w.rarity;
    item.textContent = w.name;
    itemsRow.appendChild(item);
  }
}

function flashText(text){
  const f = document.createElement('div');
  f.className='flash';
  f.textContent = text;
  container.appendChild(f);
  setTimeout(()=>f.remove(),1000);
}

openBtn.addEventListener('click',()=>{
  generateCaseItems();
  resultText.textContent='';
  itemsRow.style.transition='transform 3s cubic-bezier(0.33,1,0.68,1)';
  let shift = -Math.floor(Math.random()*15)*130;
  progressBar.style.width='0%';
  openSound.currentTime=0; openSound.play();
  
  let progress = 0;
  const interval = setInterval(()=>{
    progress += 1.8;
    progressBar.style.width=progress+'%';
    if(progress>=100){ clearInterval(interval); }
  },50);
  
  setTimeout(()=>{
    itemsRow.style.transform=`translateX(${shift}px)`; 
  },50);
  
  setTimeout(()=>{
    const wonItem = getRandomWeapon();
    resultText.textContent='Вы выиграли: '+wonItem.name;
    const histEntry = document.createElement('div');
    histEntry.textContent=wonItem.name+' ['+wonItem.rarity+']';
    historyDiv.prepend(histEntry);
    
    if(wonItem.rarity==='legendary' || wonItem.rarity==='ultra'){
      rareSound.currentTime=0; rareSound.play();
      flashText('Редкий выпад: '+wonItem.name);
      container.style.transform='translateX(5px)';
      setTimeout(()=>{container.style.transform='translateX(0)';},100);
    }
  },3100);
});

generateCaseItems();
</script>
</body>
</html>
